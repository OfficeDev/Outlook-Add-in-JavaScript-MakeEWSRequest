---
page_type: sample
products:
- office-outlook
- office-365
languages:
- javascript
description: В коде JavaScript из этого примера представлен простой запрос на получение темы текущего электронного сообщения. В нем показаны действия, необходимые для создания запроса к веб-службе Exchange (EWS), и рекомендации по его отправке.
extensions:
  contentType: samples
  technologies:
  - Add-ins
  createdDate: 8/11/2015 1:32:51 PM
---
# Надстройка Outlook: отправка запроса к веб-службе Exchange из Outlook

**Содержание**

* [Сводка](#summary)
* [Предварительные требования](#prerequisites)
* [Ключевые компоненты примера](#components)
* [Описание кода](#codedescription)
* [Сборка и отладка](#build)
* [Устранение неполадок](#troubleshooting)
* [Вопросы и комментарии](#questions)
* [Дополнительные ресурсы](#additional-resources)

<a name="summary"></a>
## Сводка
В коде JavaScript из этого примера представлен простой запрос на получение темы текущего электронного сообщения. В нем показаны действия, необходимые для создания запроса к веб-службе Exchange (EWS), и рекомендации по его отправке.

<a name="prerequisites"></a>
## Предварительные требования ##

Для этого примера требуется следующее:  

  - Visual Studio 2013 с обновлением 5 или Visual Studio 2015.  
  - Компьютер с Exchange 2013 и по крайней мере одной учетной записью электронной почты или учетной записью Office 365. Вы можете [присоединиться к Программе разработчика Office 365 и получить бесплатную годовую подписку на Office 365](https://aka.ms/devprogramsignup).
  - Любой браузер, поддерживающий ECMAScript 5.1, HTML5 и CSS3, например Internet Explorer 9, Chrome 13, Firefox 5, Safari 5.0.6 или более поздние версии этих браузеров.
  - Опыт программирования на JavaScript и работы с веб-службами.

<a name="components"></a>
## Ключевые компоненты примера
Пример решения содержит следующие файлы:

- MakeEwsRequestManifest.xml: Файл манифеста для надстройки Outlook.
- AppRead\Home\Home.html: Пользовательский интерфейс HTML для почтовой надстройки для Outlook.
- AppRead\Home\Home.js: Файл JavaScript, который обрабатывает запрос и использование запроса EWS. 

<a name="codedescription"></a>
##Описание кода

Код, создающий запрос XML EWS, включает два метода. Первый метод, `getSoapEnvelope()`, заключает запрос веб-службы в конверт SOAP. Так как конверт SOAP —стандартная оболочка для всех запросов EWS, этот метод можно использовать для любого запроса EWS.

Второй метод, `getSubjectRequest()`, возвращает запрос EWS для получения поля темы элемента. Параметр id — это идентификатор запрашиваемого элемента Exchange. Обратите внимание на следующие особенности запроса:

- Элемент `ItemShape` служит для ограничения ответа на запрос базовой фигурой `IdOnly`. В результате этого ответ будет содержать только идентификатор элемента, и предотвращается отправка с сервера лишних данных. 
- Элемент `AdditionalProperties` используется для включения в ответ поля темы. Используя базовую фигуру `IdOnly` и список дополнительных свойств, можно ограничить размер ответа от сервера так, чтобы он включал только данные, требуемые вашей надстройкой. 

Метод `sendRequest()` вызывается при нажатии кнопки **Сделать запрос EWS** в пользовательском интерфейсе надстройки. Он получает идентификатор Exchange текущего элемента и передает его в методы `getSubjectRequest()` и `getSoapEnvelope()`, а затем делает асинхронный вызов сервера Exchange с помощью метода `makeEwsRequestAsync`. Метод `makeEwsRequestAsync` принимает два параметра: запрос EWS, заключенный в конверт SOAP, и метод обратного вызова, который вызывается при завершении асинхронного запроса EWS. Если требуется передать в метод обратного вызова дополнительные сведения, можно использовать третий, необязательный параметр `userContext` метода `makeEwsRequestAsync`.

Метод `callback()` вызывается с одним параметром — `asyncResult`. Объект `asyncResult` содержит два компонента:

- `value` — содержимое ответа от EWS. 
- `context` — параметр `userContext`, переданный в метод [makeEwsRequestAsync](http://msdn.microsoft.com/library/2ec380e0-4a67-4146-92a6-6a39f65dc6f2). 

Метод `callback` в данном примере отображает содержимое ответа в прокручиваемом элементе `div` пользовательского интерфейса, однако в вашем программном коде ответ может использоваться более сложным образом.

<a name="build"></a>
## Сборка и отладка ##
**Примечание**. Почтовая надстройка будет активирована для любого сообщения электронной почты в папке «Входящие» пользователя. Вы можете упростить тестирование надстройки, отправив одно или несколько сообщений электронной почты в свою тестовую учетную запись перед запуском примера надстройки.

1. Откройте решение в Visual Studio Нажмите клавишу F5, чтобы собрать и развернуть пример надстройки.
2. Подключитесь к учетной записи Exchange, указав адрес электронной почты и пароль для сервера Exchange 2013.
3. Разрешить серверу настроить почтовую учетную запись.
4. Войдите в учетную запись электронной почты, введя имя учетной записи и пароль. 
5. Выберите сообщение в папке «Входящие».
6. Подождите, пока над сообщением появится панель надстроек.
7. На панели надстроек щелкните **MakeEWSRequest**.
8. Когда появится почтовая надстройка, нажмите кнопку **Сделать запрос EWS**, чтобы запросить тему текущего сообщения с сервера Exchange.
9. Прочитайте ответ на запрос в формате XML.

<a name="troubleshooting"></a>
##Устранение
неполадок Ниже перечислены распространенные ошибки, которые могут возникнуть при использовании Outlook Web App для проверки почтовой надстройки для Outlook:

- Панель надстроек не отображается при выборе сообщения. В этом случае перезапустите приложение, выбрав **Отладка - Остановить отладку** в окне Visual Studio, затем нажмите клавишу F5, чтобы перестроить и развернуть надстройку. 
- Изменения в коде JavaScript могут не учитываться при развертывании и запуске надстройки. Если изменения не отобраны, очистите кэш в веб-браузере, выбрав **инструменты — свойства браузера** и нажав кнопку **удалить...**. Удалите временные файлы Интернета, а затем перезапустите надстройку. 

<a name="questions"></a>
## Вопросы и комментарии ##

- Если у вас возникли проблемы с запуском этого примера, [сообщите о неполадке](https://github.com/OfficeDev/Outlook-Add-in-Javascript-MakeEWSRequest/issues).
- Вопросы о разработке надстроек Office в целом следует размещать в [Stack Overflow](http://stackoverflow.com/questions/tagged/office-addins). Обязательно помечайте свои вопросы и комментарии тегом [office-addins].


<a name="additional-resources"></a>
## Дополнительные ресурсы ##

- [Дополнительные примеры надстроек](https://github.com/OfficeDev?utf8=%E2%9C%93&query=-Add-in)
- [Сведения об управляемом API EWS, EWS и веб-службах в Exchange](https://msdn.microsoft.com/library/office/jj536567(v=exchg.150).aspx)
- [Метод makeEwsRequestAsync](http://msdn.microsoft.com/library/2ec380e0-4a67-4146-92a6-6a39f65dc6f2)

## Авторские права
(c) Корпорация Майкрософт (Microsoft Corporation), 2015. Все права защищены.


Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
